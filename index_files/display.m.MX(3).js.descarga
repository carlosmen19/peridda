(()=>{var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{default:()=>i});const s=SK.React.Component.Application,i=class extends s.Display{elements={};map=null;marker=null;default_zoom_level=10;validateAddress=function(){};constructor(e){super(e),this.state.Address=this.state.Address||[this.state.StreetAddress,this.state.City,this.state.Country].filter(e=>(e||"").trim()).join(", ").trim(),this.handleChange=this.handleChange.bind(this),this.changeDesctiption=this.changeDesctiption.bind(this),this.updateIframeData=this.updateIframeData.bind(this),this.__receiveMessage=this.__receiveMessage.bind(this)}render(){const e=this.getMapSrc();return React.createElement("div",{className:`sk-gm-wrapper ${this.state.Alignment}`},"right"==this.state.Alignment&&this.createContentEditableElement(),React.createElement("div",{className:"sk-gm-map-holder",style:{maxWidth:`${this.state.Width}px`}},React.createElement("div",{className:"sk-gm-responsive-map",style:{paddingBottom:this.state.Height/this.state.Width*100+"%"}},React.createElement("iframe",{className:"sk-gm-template",onLoad:this.updateIframeData,src:e,ref:e=>this.elements.iframe=e}))),"left"==this.state.Alignment&&this.createContentEditableElement())}componentDidMount(){this.initOnMount()}createContentEditableElement(){return React.createElement(SK.React.Component.ContentEditable,{className:"sk-gm-description",text:this.state.Description,onChange:this.changeDesctiption})}getMapSrc(){const e=this.getGoogleAPI();return e?[SK.Singletons.env.get("static_image_server"),"/Apps/GoogleMaps/gmap.htm?api_key=",e,"&instance=",this.props.node_id,"&revision=",SK.Singletons.env.get("revision")].join(""):["https://maps.google.com/maps?q=",this.state.Address?encodeURIComponent(this.state.Address):this.state.LongitudeLatitude,"&t=&z=",this.state.ZoomLevel||this.default_zoom_level,"&ie=UTF8&iwloc=&output=embed"].join("")}initOnMount(){window.addEventListener("message",this.__receiveMessage,!1),this.updateIframeData()}updateIframeData(){this.getGoogleAPI()&&this.updateMap({action:"init",options:{__in_edit_mode:this.isInEditMode(),__origin:document.location.origin,ScrollToZoom:this.state.ScrollToZoom,ZoomLevel:this.state.ZoomLevel,LongitudeLatitude:this.state.LongitudeLatitude,Directions:this.state.Directions,__directions_strings:{directions_btn:"Instrucciones",search:"Buscar"}}})}__receiveMessage(e){if(this.getGoogleAPI()&&this.props.node_id==e.data.instance&&SK.Util.filterDomainName(e.origin)===SK.Util.filterDomainName(SK.Singletons.env.get("static_image_server")))switch(e.data.action){case"alert":alert(`La solicitud de instrucciones fall√≥ debido a ${e.data.status}`);break;case"change":this.handleChange(e.data.name,e.data.value);break;case"display_address_callback":this.validateAddress(e.data.value)}}updateMap(e){this.getGoogleAPI()&&(this.elements.iframe||{}).contentWindow&&this.elements.iframe.contentWindow.postMessage(e,"*")}componentDidUpdate(e,t){this.updateMap({action:t.ScrollToZoom!=this.state.ScrollToZoom?"scrollwheel":"",options:this.state})}handleChange(e,t){this.setState({[e]:t})}displayAddress(e,t){this.validateAddress=t,this.updateMap({action:"display_address",address:e})}resizeMap(){this.updateMap({action:"resize"})}changeDesctiption(e){this.handleChange("Description",e.target.value)}getGoogleAPI(){return((this.state.__settings||{}).googleApiKey||"").trim()||(this.state.googleApiKey||"").trim()}autocompleteAPI(){return((this.state.__settings||{}).googleApiKey||"").trim()||SK.Singletons.env.get("resellerGoogleAutocompleteAPI")||(this.state.googleApiKey||"").trim()}}})(),((((SK="undefined"==typeof SK?{}:SK).Apps=SK.Apps||{}).Entry=SK.Apps.Entry||{}).GoogleMaps=SK.Apps.Entry.GoogleMaps||{}).display=t})();